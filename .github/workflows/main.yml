name: Java CI with Maven
on:  
  push:    
    branches: [ main ]  
  pull_request:    
    branches: [ main ]
# A workflow run is made up of one or more jobs

jobs:

# “build”

build:

# The type of runner that the job will run on

runs-on: ubuntu-latest

 

# Steps represent a sequence of tasks that will be executed as part of the job

steps:

 

# Checks-out your repository

- uses: actions/checkout@v2

        
– uses: actions/cache@v1        
with:

  path: ~/.m2/repository

  key: ${{ runner.os }}-maven-${{ hashFiles(‘**/pom.xml’) }}

  restore-keys: |
    ${{ runner.os }}-maven- 
      
-name: Set up Java JDK
uses: actions/setup-java@v1
    with:
    # The Java version to set up. Takes a whole or semver Java version. See examples of supported syntax in README file
    java-version: 1.8   

- name: build
run: run: mvn clean package
      # Runs a set of commands using the runners shell
      - name: Artifact file name with commit hash
        run: |
          artifactName1=$(ls target/*.jar | head -1)
          commitHash=$(git rev-parse -short "$GITHUB_SHA")
          mv $artifactName1
          
      - name: Upload a Build Artifact
        uses: actions/upload-artifact@v2.2.3
        with:
          # Artifact name
          name: build_artifact
          # A file, directory or wildcard pattern that describes what to upload
          path: target/*.jar
